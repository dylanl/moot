{% macro makemoot(moot, logged_in_user) %}
<div class="moot" id={{ moot.moot.id }}>
  <div class="moot-header">
    <a href="/users/{{ moot.user.id }}">
      <div class="avatar">
        <img src="{{ moot.user.avatar_url }}">
      </div>
      <span class="username">{{ moot.user.username }}</span>
    </a>
  </div>
  <p class="content" id="content-{{ moot.moot.id }}">
    {% autoescape false %}
    {{ moot.moot._content | e | replace("\n", "<br>") }}
    {% endautoescape %}
  </p>
  <p class="length">
    Moot length: {{ moot.moot.content|length }} --
    {{ moot.moot.human_time }} --
    <span><a href="/moots/{{ moot.moot.id }}">Direct Link</a></span>
    {%- if logged_in_user.admin %}
    -- <button onclick="del('{{ moot.moot.id }}')">Delete</button>
    -- <button onclick="hide('{{ moot.moot.id }}')">Hide</button>
    {% endif -%}
  </p>
</div>

<script>
  function del(moot) {
    fetch(`/moots/${moot}`, {
        method: "DELETE"
      }).then((resp) => {
        if (resp.status == 200) {
          betterAlert("Post deleted successfully.");
          document.getElementById(moot).remove();
        } else {
          betterAlert("Oh no! Something went wrong while processing your request!")
        }
      })
    }
  function hide(moot) {
    fetch(`/moots/${moot}`, {
        method: "PATCH"
      }).then((resp) => {
        if (resp.status == 200) {
          betterAlert("Post hidden successfully.");
          document.getElementById(`content-${moot}`).innerText = "The content of this post has been hidden by the Moot moderation team.";
        } else {
          betterAlert("Oh no! Something went wrong while processing your request!")
        }
      })
    }
</script>
{% endmacro %}